SELECT *,
CASE
-- Condição para "Ingressante" (NA nos primeiros anos e formação nos anos seguintes)
WHEN (For1218 = "NÃO PRESENTE" AND For1219 != "NÃO PRESENTE" 
      AND For1220 != "NÃO PRESENTE" AND For1221 != "NÃO PRESENTE" 
      AND For1222 != "NÃO PRESENTE" AND For1223 != "NÃO PRESENTE")
OR (For1218 = "NÃO PRESENTE" AND For1219 = "NÃO PRESENTE" 
    AND For1220 != "NÃO PRESENTE" AND For1221 != "NÃO PRESENTE" 
    AND For1222 != "NÃO PRESENTE" AND For1223 != "NÃO PRESENTE")
OR (For1218 = "NÃO PRESENTE" AND For1219 = "NÃO PRESENTE" 
    AND For1220 = "NÃO PRESENTE" AND For1221 != "NÃO PRESENTE" 
    AND For1222 != "NÃO PRESENTE" AND For1223 != "NÃO PRESENTE")
OR (For1218 = "NÃO PRESENTE" AND For1219 = "NÃO PRESENTE" 
    AND For1220 = "NÃO PRESENTE" AND For1221 = "NÃO PRESENTE" 
    AND For1222 != "NÃO PRESENTE" AND For1223 != "NÃO PRESENTE")
OR (For1218 = "NÃO PRESENTE" AND For1219 = "NÃO PRESENTE" 
    AND For1220 = "NÃO PRESENTE" AND For1221 = "NÃO PRESENTE" 
    AND For1222 = "NÃO PRESENTE" AND For1223 != "NÃO PRESENTE")
THEN "INGRESSANTE"

-- Condição para "Regular" (Formação em todos os anos)
WHEN For1218 != "NÃO PRESENTE" AND For1219 != "NÃO PRESENTE" 
AND For1220 != "NÃO PRESENTE" AND For1221 != "NÃO PRESENTE" 
AND For1222 != "NÃO PRESENTE" AND For1223 != "NÃO PRESENTE"
THEN "REGULAR"

-- Condição para "Desistente" (Formação nos anos iniciais e NA nos últimos anos)
WHEN (For1218 != "NÃO PRESENTE" AND For1219 != "NÃO PRESENTE" 
      AND For1220 != "NÃO PRESENTE" AND For1221 != "NÃO PRESENTE" 
      AND For1222 != "NÃO PRESENTE" AND For1223 = "NÃO PRESENTE")
OR (For1218 != "NÃO PRESENTE" AND For1219 != "NÃO PRESENTE" 
    AND For1220 != "NÃO PRESENTE" AND For1221 != "NÃO PRESENTE" 
    AND For1222 = "NÃO PRESENTE" AND For1223 = "NÃO PRESENTE")
OR (For1218 != "NÃO PRESENTE" AND For1219 != "NÃO PRESENTE" 
    AND For1220 != "NÃO PRESENTE" AND For1221 = "NÃO PRESENTE" 
    AND For1222 = "NÃO PRESENTE" AND For1223 = "NÃO PRESENTE")
OR (For1218 != "NÃO PRESENTE" AND For1219 != "NÃO PRESENTE" 
    AND For1220 = "NÃO PRESENTE" AND For1221 = "NÃO PRESENTE" 
    AND For1222 = "NÃO PRESENTE" AND For1223 = "NÃO PRESENTE")
OR (For1218 != "NÃO PRESENTE" AND For1219 = "NÃO PRESENTE" 
    AND For1220 = "NÃO PRESENTE" AND For1221 = "NÃO PRESENTE" 
    AND For1222 = "NÃO PRESENTE" AND For1223 = "NÃO PRESENTE")
THEN "DESISTENTE"

-- Condição para "Experiencia" (Formação em apenas um dos anos)
WHEN (For1218 = "NÃO PRESENTE" AND For1219 != "NÃO PRESENTE" 
      AND For1220 = "NÃO PRESENTE" AND For1221 = "NÃO PRESENTE" 
      AND For1222 = "NÃO PRESENTE" AND For1223 = "NÃO PRESENTE")
OR (For1218 = "NÃO PRESENTE" AND For1219 = "NÃO PRESENTE" 
    AND For1220 != "NÃO PRESENTE" AND For1221 = "NÃO PRESENTE" 
    AND For1222 = "NÃO PRESENTE" AND For1223 = "NÃO PRESENTE")
OR (For1218 = "NÃO PRESENTE" AND For1219 = "NÃO PRESENTE" 
    AND For1220 = "NÃO PRESENTE" AND For1221 != "NÃO PRESENTE" 
    AND For1222 = "NÃO PRESENTE" AND For1223 = "NÃO PRESENTE")
OR (For1218 = "NÃO PRESENTE" AND For1219 = "NÃO PRESENTE" 
    AND For1220 = "NÃO PRESENTE" AND For1221 = "NÃO PRESENTE" 
    AND For1222 != "NÃO PRESENTE" AND For1223 = "NÃO PRESENTE")
THEN "EXPERIENCIA"

-- Condição para "Intermitente" (NAs e formações intercaladas)
ELSE "INTERMITENTE"
END AS HISTORICO
FROM `tcc-base-formac.base_formac_bq.base_formac`;
